#!/bin/bash
#      \/ Banner \/
echo "IF9fICAgICAgIF9fICBfXyAgICAgICAgICAgICAgICAgIF9fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAgXCAgXyAgfCAgXHwgIFwgICAgICAgICAgICAgICAgfCAgXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCAvIFwgfCAkJCBcJCQgX19fX19fXyAgICBfX19ffCAkJCAgX19fX19fICAgX18gICBfXyAgIF9fICAgX19fX19fXyAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJC8gICRcfCAkJHwgIFx8ICAgICAgIFwgIC8gICAgICAkJCAvICAgICAgXCB8ICBcIHwgIFwgfCAgXCAvICAgICAgIFwgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCAgJCQkXCAkJHwgJCR8ICQkJCQkJCRcfCAgJCQkJCQkJHwgICQkJCQkJFx8ICQkIHwgJCQgfCAkJHwgICQkJCQkJCQgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCAkJFwkJFwkJHwgJCR8ICQkICB8ICQkfCAkJCAgfCAkJHwgJCQgIHwgJCR8ICQkIHwgJCQgfCAkJCBcJCQgICAgXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCQkICBcJCQkJHwgJCR8ICQkICB8ICQkfCAkJF9ffCAkJHwgJCRfXy8gJCR8ICQkXy8gJCRfLyAkJCBfXCQkJCQkJFwgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCQgICAgXCQkJHwgJCR8ICQkICB8ICQkIFwkJCAgICAkJCBcJCQgICAgJCQgXCQkICAgJCQgICAkJHwgICAgICAgJCQgICAgICAgICAgICAgICAgICAgICAgICAgICAKIFwkJCAgICAgIFwkJCBcJCQgXCQkICAgXCQkICBcJCQkJCQkJCAgXCQkJCQkJCAgIFwkJCQkJFwkJCQkICBcJCQkJCQkJCAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIF9fX19fX19fICAgICAgICAgICAgICAgICAgICAgIF9fICAgICAgICAgICAgX18gICAgX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAgICAgICAgXCAgICAgICAgICAgICAgICAgICAgfCAgXCAgICAgICAgICB8ICBcICB8ICBcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCQkJCQkJCBfXyAgICBfXyAgIF9fX19fXyAgfCAkJCAgX19fX19fICAgXCQkIF98ICQkXyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJF9fICAgIHwgIFwgIC8gIFwgLyAgICAgIFwgfCAkJCAvICAgICAgXCB8ICBcfCAgICQkIFwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCAgXCAgICBcJCRcLyAgJCR8ICAkJCQkJCRcfCAkJHwgICQkJCQkJFx8ICQkIFwkJCQkJCQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCQkJCAgICAgPiQkICAkJCB8ICQkICB8ICQkfCAkJHwgJCQgIHwgJCR8ICQkICB8ICQkIF9fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJF9fX19fICAvICAkJCQkXCB8ICQkX18vICQkfCAkJHwgJCRfXy8gJCR8ICQkICB8ICQkfCAgXCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKfCAkJCAgICAgXHwgICQkIFwkJFx8ICQkICAgICQkfCAkJCBcJCQgICAgJCR8ICQkICAgXCQkICAkJCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIFwkJCQkJCQkJCBcJCQgICBcJCR8ICQkJCQkJCQgIFwkJCAgXCQkJCQkJCAgXCQkICAgIFwkJCQkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB8ICQkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB8ICQkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgXCQkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKIF9fX19fX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgX18gICAgICAgICAgICAgICAgICAgICAKfCAgICAgICBcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICBcICAgICAgICAgICAgICAgICAgICAgICAgICB8ICBcICAgICAgICAgICAgICAgICAgICAKfCAkJCQkJCQkXCAgX19fX19fICAgX18gICBfXyAgIF9fICBfX19fX19fICB8ICQkICBfX19fX18gICAgX19fX19fICAgIF9fX198ICQkICBfX19fX18gICAgX19fX19fICAKfCAkJCAgfCAkJCAvICAgICAgXCB8ICBcIHwgIFwgfCAgXHwgICAgICAgXCB8ICQkIC8gICAgICBcICB8ICAgICAgXCAgLyAgICAgICQkIC8gICAgICBcICAvICAgICAgXCAKfCAkJCAgfCAkJHwgICQkJCQkJFx8ICQkIHwgJCQgfCAkJHwgJCQkJCQkJFx8ICQkfCAgJCQkJCQkXCAgXCQkJCQkJFx8ICAkJCQkJCQkfCAgJCQkJCQkXHwgICQkJCQkJFwKfCAkJCAgfCAkJHwgJCQgIHwgJCR8ICQkIHwgJCQgfCAkJHwgJCQgIHwgJCR8ICQkfCAkJCAgfCAkJCAvICAgICAgJCR8ICQkICB8ICQkfCAkJCAgICAkJHwgJCQgICBcJCQKfCAkJF9fLyAkJHwgJCRfXy8gJCR8ICQkXy8gJCRfLyAkJHwgJCQgIHwgJCR8ICQkfCAkJF9fLyAkJHwgICQkJCQkJCR8ICQkX198ICQkfCAkJCQkJCQkJHwgJCQgICAgICAKfCAkJCAgICAkJCBcJCQgICAgJCQgXCQkICAgJCQgICAkJHwgJCQgIHwgJCR8ICQkIFwkJCAgICAkJCBcJCQgICAgJCQgXCQkICAgICQkIFwkJCAgICAgXHwgJCQgICAgICAKIFwkJCQkJCQkICAgXCQkJCQkJCAgIFwkJCQkJFwkJCQkICBcJCQgICBcJCQgXCQkICBcJCQkJCQkICAgXCQkJCQkJCQgIFwkJCQkJCQkICBcJCQkJCQkJCBcJCQgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA=" | base64 -d 
WD=$(pwd)
test=$(locate wes.py)
cd ${test%??????} 
python wes.py $1 -o /tmp/winvuln.txt
cd $WD
echo "usage: ./WED.sh [systeminfo.txt]"
rm -r Exploits4thewin
echo "system reguirements:"
echo "wes-ng"
echo "searchsploit"
echo "locate"
echo "Creating new folder for the exploits..."
mkdir Exploits4thewin
echo "privesc CVE's found: "
cat -n  /tmp/winvuln.txt | grep  "Elev" | grep CVE | cut -d ',' -f2 | cut -d ',' -f1 | sort | uniq | tr -d '"' > Exploits4thewin/PrivCVE.txt
cat -n Exploits4thewin/PrivCVE.txt
echo "RCE CVE's: "
cat -n  /tmp/winvuln.txt | grep  "Remote" | grep CVE | cut -d ',' -f2 | cut -d ',' -f1 | sort | uniq | tr -d '"' > Exploits4thewin/RCE_CVE.txt
cat -n Exploits4thewin/RCE_CVE.txt
echo "partial linkdump:"
cat -n /tmp/winvuln.txt| grep http | rev | cut -d ',' -f1 | rev | tr -d '"' | uniq
cat /tmp/winvuln.txt | grep  "Exploit: htt"  | grep exploit-db | grep -oe '\([0-9]*\)' | grep -x '.\{4,6\}' | uniq > Exploits4thewin/edb.txt
cd Exploits4thewin
cat edb.txt | xargs -L1 searchsploit -m 
echo "Relevant windows exploits have been downloaded/pulled from exploit-db!"
echo " "
echo "Exploit Code:"
ls -lisa | grep -v txt
echo " "
echo "Exploit Manuals:"
ls -lisa | grep txt
echo "Thanks for using Windows Exploit Downloader!"
echo "Written by: n3oW0x1f"
cd ..

